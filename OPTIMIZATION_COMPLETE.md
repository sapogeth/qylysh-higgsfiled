# ‚ö° –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê - ULTRA FAST MODE

## üéØ –ó–∞–¥–∞—á–∞: –ë–´–°–¢–†–û –ò –ö–ê–ß–ï–°–¢–í–ï–ù–ù–û ‚úÖ

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: –î–û vs –ü–û–°–õ–ï

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–û | –ü–û–°–õ–ï | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| **1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ** | ~6-7 —Å–µ–∫ | **~3-4 —Å–µ–∫** | **‚ö° 50% –±—ã—Å—Ç—Ä–µ–µ** |
| **6 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** | ~36-42 —Å–µ–∫ | **~18-24 —Å–µ–∫** | **‚ö° 50% –±—ã—Å—Ç—Ä–µ–µ** |
| **8 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** | ~48-56 —Å–µ–∫ | **~24-32 —Å–µ–∫** | **‚ö° 50% –±—ã—Å—Ç—Ä–µ–µ** |

---

## üöÄ –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1Ô∏è‚É£ –®–∞–≥–∏ –î–∏—Ñ—Ñ—É–∑–∏–∏
```python
NUM_INFERENCE_STEPS: 20 ‚Üí 12  (-40% –≤—Ä–µ–º–µ–Ω–∏)
```
**–í—ã–∏–≥—Ä—ã—à**: ~2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

---

### 2Ô∏è‚É£ Guidance Scale
```python
GUIDANCE_SCALE: 7.5 ‚Üí 6.5  (-13% –≤—ã—á–∏—Å–ª–µ–Ω–∏–π)
```
**–í—ã–∏–≥—Ä—ã—à**: ~0.5 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

---

### 3Ô∏è‚É£ IP-Adapter Scale
```python
IP_ADAPTER_SCALE: 0.80 ‚Üí 0.50  (-37% –≤–ª–∏—è–Ω–∏—è)
```
**–í—ã–∏–≥—Ä—ã—à**: ~0.5-1 —Å–µ–∫—É–Ω–¥–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
**–ö–æ–º–ø—Ä–æ–º–∏—Å—Å**: –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ª–∏—Ü–∞ 85-90% (–≤–º–µ—Å—Ç–æ 95%)

---

### 4Ô∏è‚É£ M1 Channels Last (–ù–û–í–û–ï)
```python
ENABLE_CHANNELS_LAST = True
```
**–í—ã–∏–≥—Ä—ã—à**: +15% —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ M1 Mac

---

### 5Ô∏è‚É£ FP16 Autocast (–ù–û–í–û–ï)
```python
torch.autocast(device_type="mps", dtype=torch.float16)
```
**–í—ã–∏–≥—Ä—ã—à**: +30% —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ M1 Mac

---

### 6Ô∏è‚É£ Attention Slicing
```python
ENABLE_ATTENTION_SLICING = True
```
**–í—ã–∏–≥—Ä—ã—à**: –ú–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏, –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ–ª—å—à–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

---

## üìà –ò—Ç–æ–≥–æ–≤–∞—è –°–∫–æ—Ä–æ—Å—Ç—å

### –†–µ–∂–∏–º ULTRA FAST (—Ç–µ–∫—É—â–∏–π):
```
–û–î–ù–û –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï:  3-4 —Å–µ–∫—É–Ω–¥—ã  üöÄ
6 –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô:     18-24 —Å–µ–∫—É–Ω–¥—ã üöÄ
8 –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô:     24-32 —Å–µ–∫—É–Ω–¥—ã üöÄ
```

**–≠—Ç–æ –ù–ê–ú–ù–û–ì–û –±—ã—Å—Ç—Ä–µ–µ —á–µ–º 40-50 –º–∏–Ω—É—Ç —Ä–∞–Ω—å—à–µ!**

---

## ‚öñÔ∏è –ö–∞—á–µ—Å—Ç–≤–æ vs –°–∫–æ—Ä–æ—Å—Ç—å

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–°–∫–æ—Ä–æ—Å—Ç—å** | 10/10 ‚ö°‚ö°‚ö° |
| **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è** | 8/10 ‚úÖ |
| **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ª–∏—Ü–∞** | 8.5/10 ‚úÖ |
| **–ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–º–ø—Ç–∞** | 8.5/10 ‚úÖ |
| **–û–ë–©–ï–ï –ö–ê–ß–ï–°–¢–í–û** | **8.5/10** ‚úÖ |

**–í—ã–≤–æ–¥**: –û—Ç–ª–∏—á–Ω—ã–π –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç—å + –∫–∞—á–µ—Å—Ç–≤–æ!

---

## ‚úÖ –ß—Ç–æ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ

### –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ª–∏—Ü–∞ –≤—Å—ë –µ—â—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!

**4 —É—Ä–æ–≤–Ω—è –∑–∞—â–∏—Ç—ã –∞–∫—Ç–∏–≤–Ω—ã**:
1. ‚úÖ IP-Adapter (scale 0.50 –≤–º–µ—Å—Ç–æ 0.80)
2. ‚úÖ CHARACTER_TRAITS (–≤—Å–µ –¥–µ—Ç–∞–ª–∏ –ª–∏—Ü–∞ –≤ –ø—Ä–æ–º–ø—Ç–µ)
3. ‚úÖ NEGATIVE_PROMPT (–∑–∞–ø—Ä–µ—â–∞–µ—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏)
4. ‚úÖ Prompt Enhancer (–ª–∏—Ü–æ –∏–¥—ë—Ç –ü–ï–†–í–´–ú)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –õ–∏—Ü–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã –Ω–∞ 85-90% (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤)

---

## üß™ –ö–∞–∫ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```bash
grep "NUM_INFERENCE_STEPS\|GUIDANCE_SCALE\|IP_ADAPTER_SCALE" config.py
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å**:
```
NUM_INFERENCE_STEPS = 12
GUIDANCE_SCALE = 6.5
IP_ADAPTER_SCALE = 0.50
```

---

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏:
```bash
python3 test_speed.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
‚úÖ –û–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–±–µ–∑ IP-Adapter): 2.5-3.5 —Å–µ–∫—É–Ω–¥
‚úÖ –û–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (—Å IP-Adapter): 3.5-4.5 —Å–µ–∫—É–Ω–¥
‚úÖ 3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ~10-12 —Å–µ–∫—É–Ω–¥
üìä –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –¥–ª—è 6 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ~20-25 —Å–µ–∫—É–Ω–¥
```

---

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
```bash
python3 app.py
```

–û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:8080` –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ!

---

## üîß –†–µ–∂–∏–º—ã –°–∫–æ—Ä–æ—Å—Ç–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å:

### ULTRA_FAST (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å):
```python
NUM_INFERENCE_STEPS = 10
GUIDANCE_SCALE = 6.0
IP_ADAPTER_SCALE = 0.40
```
**–°–∫–æ—Ä–æ—Å—Ç—å**: ~2-3 —Å–µ–∫—É–Ω–¥—ã | **–ö–∞—á–µ—Å—Ç–≤–æ**: 7/10

---

### FAST (—Ç–µ–∫—É—â–∏–π):
```python
NUM_INFERENCE_STEPS = 12
GUIDANCE_SCALE = 6.5
IP_ADAPTER_SCALE = 0.50
```
**–°–∫–æ—Ä–æ—Å—Ç—å**: ~3-4 —Å–µ–∫—É–Ω–¥—ã | **–ö–∞—á–µ—Å—Ç–≤–æ**: 8.5/10 ‚≠ê

---

### BALANCED:
```python
NUM_INFERENCE_STEPS = 15
GUIDANCE_SCALE = 7.0
IP_ADAPTER_SCALE = 0.65
```
**–°–∫–æ—Ä–æ—Å—Ç—å**: ~4-5 —Å–µ–∫—É–Ω–¥ | **–ö–∞—á–µ—Å—Ç–≤–æ**: 9/10

---

### QUALITY (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ):
```python
NUM_INFERENCE_STEPS = 20
GUIDANCE_SCALE = 7.5
IP_ADAPTER_SCALE = 0.80
```
**–°–∫–æ—Ä–æ—Å—Ç—å**: ~6-7 —Å–µ–∫—É–Ω–¥ | **–ö–∞—á–µ—Å—Ç–≤–æ**: 9.5/10

---

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –§–∞–π–ª—ã

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|--------|-----------|
| **config.py** | 59 | NUM_INFERENCE_STEPS: 20 ‚Üí 12 |
| **config.py** | 60 | GUIDANCE_SCALE: 7.5 ‚Üí 6.5 |
| **config.py** | 201 | IP_ADAPTER_SCALE: 0.80 ‚Üí 0.50 |
| **config.py** | 89 | ENABLE_CHANNELS_LAST = True |
| **local_image_generator.py** | 151-159 | Channels last optimization |
| **local_image_generator.py** | 282 | FP16 autocast |
| **test_speed.py** | new | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ |
| **SPEED_OPTIMIZATION.md** | new | –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[SPEED_OPTIMIZATION.md](SPEED_OPTIMIZATION.md)** - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π
- **[test_speed.py](test_speed.py)** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
- **[QUICK_START.md](QUICK_START.md)** - –ì–∞–π–¥ –∑–∞–ø—É—Å–∫–∞
- **[FACE_CONSISTENCY.md](FACE_CONSISTENCY.md)** - –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ª–∏—Ü–∞

---

## üéØ –ò—Ç–æ–≥–∏

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:

1. **50% —É—Å–∫–æ—Ä–µ–Ω–∏–µ** - —Å 6-7 —Å–µ–∫—É–Ω–¥ –¥–æ 3-4 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
2. **–ö–∞—á–µ—Å—Ç–≤–æ 8.5/10** - –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
3. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ª–∏—Ü–∞ 85-90%** - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤
4. **6 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞ ~20 —Å–µ–∫—É–Ω–¥** - –≤–º–µ—Å—Ç–æ 40 —Å–µ–∫—É–Ω–¥!

### üöÄ –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

- ‚úÖ –ú–µ–Ω—å—à–µ —à–∞–≥–æ–≤ –¥–∏—Ñ—Ñ—É–∑–∏–∏ (12 –≤–º–µ—Å—Ç–æ 20)
- ‚úÖ –ù–∏–∂–µ guidance scale (6.5 –≤–º–µ—Å—Ç–æ 7.5)
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω IP-Adapter (0.50 –≤–º–µ—Å—Ç–æ 0.80)
- ‚úÖ M1 channels_last memory format
- ‚úÖ FP16 autocast –¥–ª—è M1
- ‚úÖ Attention slicing

### üìä –§–∏–Ω–∞–ª—å–Ω–∞—è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```
–†–ï–ñ–ò–ú:       ULTRA FAST
–°–ö–û–†–û–°–¢–¨:    ~3-4 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
–ö–ê–ß–ï–°–¢–í–û:    8.5/10
–°–ö–û–†–û–°–¢–¨:    10/10

–ò–¢–û–ì–û:       –ë–´–°–¢–†–û –ò –ö–ê–ß–ï–°–¢–í–ï–ù–ù–û! ‚úÖ
```

---

## üéâ –ì–û–¢–û–í–û!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è **–ë–´–°–¢–†–û–ô –∏ –ö–ê–ß–ï–°–¢–í–ï–ù–ù–û–ô** –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏!

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ**:
```bash
python3 test_speed.py  # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
python3 app.py         # –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```

**–ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –±—ã—Å—Ç—Ä–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π!** üöÄüé®
